## Malware Analysis Guidebook

## Introduction

This guidebook is designed to help you understand and analyze different types of malware, focusing on four major types: Backdoor, Banking Trojan, Cryptolocker Ransomware, and Encrypted Virus. Additionally, we will explore six essential detection methods: File System Monitoring, Port Scanning, Time Stamp Analysis, Heuristic Analysis, Payload Disassembly, and Entropy Analysis. Each detection method helps in ruling out certain malware types based on observable outcomes.

## Malware Types

1. **Backdoor**: This type of malware allows attackers to gain unauthorized access to a computer system, bypassing normal authentication procedures. Backdoors can be used to obscure the attacker’s presence and facilitate further attacks.

2. **Banking Trojan**: This malware is designed specifically to steal sensitive financial information from users, such as bank account details and passwords. It often works by intercepting data during online transactions.

3. **Cryptolocker Ransomware**: This is a type of ransomware that encrypts files on a victim's device, rendering them inaccessible. The attacker demands a ransom payment in exchange for a decryption key.

4. **Encrypted Virus**: This is a virus that uses encryption to hide and protect its malicious payload from being detected or analyzed by antivirus software or analysts.

## Detection Methods and Outcomes

### 1. File System Monitoring
This method involves observing changes made to the file system to detect suspicious activities.

- **No File Changes**: Observing no changes in the file system does not exclude any specific malware type.
  
- **Files Created**: If files are being created, it does not specifically rule out any malware type, but it still indicates suspicious behavior worth further investigation.
  
- **Files Encrypted**: If files are encrypted, Cryptolocker Ransomware is excluded.

### 2. Port Scanning
Port scanning helps in identifying open or unusual ports that may be used by malware for communication.

- **No Open Ports**: Observing no open ports does not exclude any specific malware type.
  
- **Common Ports Open**: The presence of common open ports does not rule out any specific malware but suggests normal network activity.
  
- **Unusual Ports Open**: If unusual ports are open, Backdoor is excluded.

### 3. Time Stamp Analysis
This involves checking the consistency of file time stamps to identify tampering.

- **Consistent Time Stamps**: When time stamps are consistent, an Encrypted Virus is excluded.
  
- **Time Stamps Mismatch**: Any mismatch in time stamps indicates potential tampering but does not exclusively rule out any specific malware type.
  
- **Modified Time Stamps**: Similar to time stamps mismatch, modified time stamps suggest tampering but do not rule out specific malware types.

### 4. Heuristic Analysis
Heuristic analysis involves using rules or algorithms to detect patterns indicative of malware.

- **No Heuristics Matched**: When no heuristics match, it does not exclude any specific malware type.
  
- **Suspicious Patterns Found**: Finding suspicious patterns suggests malware activity but does not directly rule out any specific type.
  
- **Heuristics Matched**: If heuristics match those associated with an Encrypted Virus, then Encrypted Virus is excluded.

### 5. Payload Disassembly
This method involves breaking down the malware’s code to understand its structure and behavior.

- **Cannot Disassemble**: When a payload cannot be disassembled, Encrypted Virus is excluded.
  
- **Partial Disassembly**: Partial disassembly doesn't specifically rule out any malware types but suggests complexity in the payload.
  
- **Full Disassembly**: If the payload is fully disassembled, you can often rule out highly complex or encrypted malware like Encrypted Viruses.

### 6. Entropy Analysis
Entropy analysis measures the randomness of data to detect encrypted or compressed malware.

- **Entropy Range (0.0 - 3.5)**: This low entropy range does not exclude any specific malware type.
  
- **Entropy Range (3.6 - 7.5)**: Suggests moderate randomness, typically not ruling out any specific malware type.
  
- **Entropy Range (7.6 - 10.0)**: High entropy often indicates encryption or compression, excluding Encrypted Viruses.

## Conclusion

By applying these detection methods and understanding their outcomes, you can effectively rule out certain malware types and narrow down the possibilities, leading to more accurate detection and analysis. Always remember, multiple methods should be used in conjunction to improve accuracy and reduce false positives in malware detection.